{% extends "layout.html" %}

{% block content %}

<div class="history-container container mt-5">
    <h1 class="page-title">Prediction History for {{ username }}</h1>

    <!-- Filter and Search Section -->
    <div class="filter-section">
        <div class="row g-3">
            <!-- Multi-letter Search (Only uppercase continuous letters like AB) -->
            <div class="col-md-3">
                <input type="text" id="search-letters" class="form-control" placeholder="Search letters (e.g., AB)" autocomplete="off">
                <small class="text-danger d-none" id="search-error">Only uppercase letters allowed without spaces or commas.</small>
            </div>

            <!-- Sort by Date -->
            <div class="col-md-3">
                <select id="sort-by" class="form-control">
                    <option value="recent">Sort by Recent</option>
                    <option value="oldest">Sort by Oldest</option>
                </select>
            </div>

            <!-- Colormap Filter (Dropdown checklist with scrollable options) -->
            <div class="col-md-3">
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle form-control" type="button" id="colormap-dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        Filter Colors
                    </button>
                    <ul class="dropdown-menu" id="colormap-filter" style="max-height: 150px; overflow-y: auto;">
                        <!-- Colormap options will be injected here via JavaScript -->
                    </ul>
                </div>
            </div>

            <!-- Date Range Picker (Merged Start and End Dates) -->
            <div class="col-md-3">
                <input type="text" id="date-range" class="form-control" placeholder="Select date range" readonly>
            </div>

            <!-- Show Favorites -->
            <div class="col-md-3">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="show-favorites">
                    <label class="form-check-label" for="show-favorites">Show Favorites Only</label>
                </div>
            </div>

            <!-- Reset All Filters Button -->
            <div class="col-md-3">
                <button id="reset-filters" class="btn reset-filters">Reset All Filters</button>
            </div>
        </div>
    </div>

    <!-- Container for Entries -->
    <div id="entries-container" class="card-grid">
        <!-- Entries will be displayed here -->
    </div>

    <!-- Loading Spinner -->
    <div id="loading" class="text-center my-4" style="display: none;">
        <i class="fa fa-spinner fa-spin fa-2x"></i> Loading more entries...
    </div>

</div>

<!-- Include Flatpickr CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<!-- Include External JavaScript -->
<script src="{{ url_for('static', filename='js/history.js') }}"></script>

{% endblock %}
